<!doctype html>

<html lang="en">

  <head>
    <title>Three.js</title>
    <style>
      body {margin: 0;}
      canvas {width: 100%; height: 100%; }
    </style>
  </head>

  <body>
        <script src="js/three.js"></script>
        <script src="js/MapControls.js"></script>
        <script src="js/OBJLoader.js"></script>
        <script>
          // Scene
          var scene = new THREE.Scene( );
          var renderer = new THREE.WebGLRenderer( { antialias: true } );
          scene.background = new THREE.Color( 0x000000 );
          // scene.fog = new THREE.FogExp2( 0xcccccc, 0.2 );
          var width = window.innerWidth;
          var height = window.innerHeight;
          renderer.setSize( width, height );
          document.body.appendChild( renderer.domElement );

          // Events: resizing
          window.addEventListener('resize', function()
          {
            var width = window.innerWidth;
            var height = window.innerHeight;
            renderer.setSize( width, height );
            camera.aspect = width / height;
            camera.updateProjectionMatrix( );
          } );

          // Material, Color, Texture
          var material = new THREE.MeshPhongMaterial( { color: 0x772200, flatShading: true } );

          // Lights
          var light = new THREE.DirectionalLight( 0xffffff, .5 );
  				light.position.set( 5000, 7000, 2000 );
  				scene.add( light );
  				// var light = new THREE.DirectionalLight( 0xffffff, 1 );
  				// light.position.set( - 2000, - 5000, - 10000 );
  				// scene.add( light );
  				var light = new THREE.AmbientLight( 0xFFFFFF, 0.5 );
  				scene.add( light );

          // Model
          // instantiate a loader
          var loader = new THREE.OBJLoader( );

          // load a resource
          loader.load(
          	// resource URL
          	'models/low_poly_buildings.obj',
          	// called when resource is loaded
          	handle_load,
          	// called when loading is in progresses
          	function ( xhr ) {

          		console.log( ( xhr.loaded / xhr.total * 100 ) + '% loaded' );

          	},
          	// called when loading has errors
          	function ( error ) {

          		console.log( 'An error happened' );

          	}
          );

          function handle_load( object )
          {
            object.materialLibraries = Array(object.children.length).fill(material)
            scene.add(object)
            console.log(object)
          }


          // Shapes


          // Camera
          var camera = new THREE.PerspectiveCamera( 70, window.innerWidth / window.innerHeight, 0.1, 10000 );
          camera.position.set( 1500, 1200, 2000 );

          // controllers
          controls = new THREE.MapControls( camera, renderer.domElement );



          // game logic
          var update = function( )
          {
            // loader.setMaterials( material );
            // cube.rotation.x += 0.010
            // cube.rotation.y += 0.005
          };
          // draw the scene
          var render = function( )
          {
            renderer.render( scene, camera );
          };

          // run GameLoop(update, render, repeat)
          var GameLoop = function( )
          {
            requestAnimationFrame( GameLoop );
            update( );
            render( );
          };

          GameLoop( );

        </script>
  </body>

</html>
